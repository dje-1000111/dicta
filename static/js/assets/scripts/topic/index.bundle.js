(()=>{var e={344:()=>{document.getElementById("subh"),document.querySelector("main")&&document.querySelector("main"),document.addEventListener("dblclick",(function(){if(window.getSelection){var n=window.getSelection().toString(),i=[".",",",":",";","!","?","%","/","<",">","&","#","£","§",'"',"{","}","(",")","@","[","]"," ","⭐"];for(char of n)i.includes(char)&&(n=n.replace(char,""));n.length>0&&dictmod.show()}!i.includes(n)&&n.length>0&&n.length<27&&fetch(prde,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8","X-CSRFToken":csrftoken},body:JSON.stringify(n)}).then((async e=>e.json())).then((i=>{var l=JSON.parse(i.defs);document.getElementById("dictionary-content")&&document.getElementById("dictionary-content").remove(),t.innerHTML="";let a=document.createElement("div");if(a.id="dictionary-content",divTitleContent=document.createTextNode(`${n.charAt(0).toUpperCase()+n.slice(1)}`),t.appendChild(divTitleContent),Object.keys(i.defs).includes("no-result"))document.createElement("p"),pContent=document.createTextNode("No Definition found."),a.appendChild(pContent);else for(const[e,t]of Object.entries(l))if(Object.keys(t).length>0){(d=document.createElement("ul")).className="title";var d,o=document.createTextNode(`${e}`);(c=document.createElement("li")).appendChild(o),d.appendChild(c),a.appendChild(d),(d=document.createElement("ul")).className="def";for(const[e,n]of Object.entries(t)){let e=document.createTextNode(`${n}`);var c=document.createElement("li");"Missing definition in Wiktionary."==n&&(c.className="missing"),c.appendChild(e),d.appendChild(c),a.appendChild(d)}}e.appendChild(a)}))}));var e=document.getElementById("dictionary"),t=document.getElementById("dictionary-title")},779:()=>{const e=document.getElementById("blur");if(document.getElementById("blur-btn"))var t=document.getElementById("blur-btn"),n=document.getElementById("iblur");blurStatus=0,t&&(t.onclick=function(){0===blurStatus?(n.classList.replace("fa-droplet","fa-droplet-slash"),e.classList.add("blur-vid"),blurStatus=1):(n.classList.replace("fa-droplet-slash","fa-droplet"),e.classList.remove("blur-vid"),blurStatus=0)})},135:()=>{var e=document.getElementById("imgb64");if(document.getElementById("imgb64")){var t=function(e){var t,n,i,l={r:12.9,g:58.8,b:95.3},a=document.createElement("canvas"),d=a.getContext&&a.getContext("2d"),o=-4,c={r:0,g:0,b:0},r=0;if(!d)return l;n=a.height=e.naturalHeight||e.offsetHeight||e.height,t=a.width=e.naturalWidth||e.offsetWidth||e.width,d.drawImage(e,0,0);try{imageData=d.getImageData(0,0,t,n)}catch(e){return console.warn("Image not compatible"),l}for(i=imageData.data.length;(o+=20)<i;)++r,c.r+=imageData.data[o],c.g+=imageData.data[o+1],c.b+=imageData.data[o+2];return c.r=~~(c.r/r),c.g=~~(c.g/r),c.b=~~(c.b/r),c}(e);document.documentElement.style.setProperty("--dynamic-color",`rgb(${t.r}, ${t.g}, ${t.b})`),document.body.classList.add("background-gradient")}},818:()=>{document.querySelectorAll("input[type=radio][name=rate]").forEach((function(e){e.addEventListener("change",(function(t){t.preventDefault(),1==e.checked&&async function(e,t,n){try{const i=await fetch(e,{method:"POST",body:JSON.stringify(t),dataType:"json",headers:n});return await i.json()}catch(e){return console.warn(e)}}(aprr,{star_rating:t.target.value,dictation_id:t.target.id},{Accept:"application/json","Content-Type":"application/json","X-CSRFToken":csrftoken})}))}))}},t={};function n(i){var l=t[i];if(void 0!==l)return l.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,n),a.exports}(()=>{"use strict";n(344),n(779),n(135);var e=[],t=[];var i=document.getElementById("story-segment"),l=[];function a(n,a){let d=document.createElement("li"),o=document.createElement("i");o.className="fa-solid fa-copy custom-facp",l.includes(a)||(window[`textline${counter}`]=document.createTextNode(`${a} - ${n}`),l.push(a),d.appendChild(window[`textline${counter}`]),i.appendChild(d),t.push(n),window[`btn${lineNb}`]=document.createElement("button"),window[`btn${lineNb}`].className="btn",window[`btn${lineNb}`].id=`copy-${lineNb}`,window[`btn${lineNb}`].appendChild(o),d.appendChild(window[`btn${lineNb}`]),e.push(window[`btn${lineNb}`]),e.forEach((n=>{n.addEventListener("click",(function(i){!async function(e){try{await navigator.clipboard.writeText(e)}catch(e){return console.warn("Failed to copy: ",e)}}(t[e.indexOf(n)])}))})))}async function d(e,t,n){try{const i=await fetch(e,{method:"POST",body:JSON.stringify(t),headers:n});return await i.json()}catch(e){return console.warn(e)}}const o={Accept:"application/json","Content-Type":"application/json","X-CSRFToken":csrftoken};if(document.getElementById("id_textarea"))var c=document.getElementById("id_textarea").value;var r=document.getElementById("counter"),s=document.getElementById("check"),u=document.getElementById("reveal"),m=document.getElementById("result_correction"),p=0,g=!1,b=!1;const h=document.getElementById("tip");var f,v,y,N,E=0;function w(e){redId=e.target.parentElement.id,lineNb=Number(redId),player.seekTo(ts[lineNb],!0),setTimeout((()=>{player.playVideo()}),10),done=!0,paused=!1,L(),r.innerHTML=lineNb,lines.includes(lineNb)?create_level_valid():del_level_valid(),np=!0,u.innerHTML=E>0?`<i class="fa-solid fa-${E} w-ctrl"></i>`:'<i class="fa-solid fa-0 w-ctrl"></i>'}function I(){p=ts[lineNb],player.seekTo(p,!0),setTimeout((()=>{player.playVideo()}),10),done=!0,paused=!1,document.getElementById("id_textarea").value="",g=!1,m.innerHTML="",E=0,_(),r.innerHTML=lineNb,L()}function L(){h.innerHTML=void 0!==tip[lineNb]?`<i class="fa-solid fa-lightbulb"></i> ${tip[lineNb]}`:h.innerHTML=""}function _(){u.innerHTML=E?`<i class="fa-solid fa-${E} w-ctrl"></i>`:'<i class="fa-solid fa-0 w-ctrl"></i>',b=!1}function x(e){return e.toSorted(((e,t)=>e-t))}function C(e,t){var n=e.indexOf(t);return e[n+1]}function T(e,t){null!=document.getElementById(e)?(document.getElementById(e).lastChild.classList.remove("red"),document.getElementById(e).lastChild.classList.add("green")):null!=document.getElementById(t)&&(document.getElementById(t).lastChild.classList.remove("red"),document.getElementById(t).lastChild.classList.add("green"))}function B(e){return Math.floor(Math.random()*e)}redleds.forEach((e=>{!0===rmEvent?e.removeEventListener("click",w,{passive:!0}):e.addEventListener("click",w)}));const S=["Good job","Great job","Nice work"];var k=x(reds),$=x(realLines);function H(){let e=document.getElementById("exomodal");e.classList.contains("exodnone")&&(e.classList.remove("exodnone"),e.classList.add("exodflex"))}function M(e){let t=$.indexOf(e);return t>-1&&$.splice(t,1),$}function O(e){let t=k.indexOf(e);return t>-1&&k.splice(t,1),k}(function(){let e=document.getElementById("tcontainer");var t=document.createElement("div");t.id="exomodal",t.className="exodnone";let n=document.createElement("div");n.className="exomodal-content";let i=document.createElement("hr"),l=document.createElement("p");l.id="reset";let a=document.createTextNode(`${S[B(3)]}, you have finished this exercise. Please choose another or reset this one.`),d=document.createTextNode(`${S[B(3)]}, you have finished this exercise. You can refresh the page to do it again or choose another exercise.`),o=uia?a:d;l.appendChild(o),l.appendChild(i),n.appendChild(l),t.appendChild(n),e.insertBefore(t,e.firstChild),function(){let e=document.createElement("a");e.href=backhomeUrl,e.className="btn btn-success me-3 float-start",e.id="backhome";let t=document.createTextNode("Home");e.appendChild(t),document.querySelector("#reset").appendChild(e)}(),function(){let e=document.createElement("a"),t=uia?"Reset":"Refresh";e.className="btn btn-danger float-end",e.id="resetid";let n=document.createTextNode(t);e.appendChild(n),document.querySelector("#reset").appendChild(e)}()})(),document.getElementById("resetid").addEventListener("click",(function(){d("/aptc/",{reset:!0,lineNb:0,new_text:c,topicname,reveal_status:b,new_page:!0,dictation_id,vaseg:!1},o),location.reload()})),uia||document.getElementById("backhome").addEventListener("click",(function(){d("/aptc/",{reset:!0,lineNb:0,new_text:c,topicname,reveal_status:b,new_page:!0,dictation_id,vaseg:!1},o)})),uia&&!k.length>0&&window.addEventListener("load",H),document.onreadystatechange=()=>{"complete"===document.readyState&&d("/aptc/",{reset:!1,line_nb:Number(lineNb),new_text:c,topicname,reveal_status:b,new_page:!1,dictation_id,vaseg:!1},o)};var j=[],D=[];function q(e){return decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}function P(){0==D.length&&D.push(lineNb),!0===b&&(b=!1),u.innerHTML=E?`<i class="fa-solid fa-${E} w-ctrl"></i>`:'<i class="fa-solid fa-0 w-ctrl"></i>',y&&!0===g&&(j.includes(lineNb)||j.push(lineNb)),y&&!0===g?(lines.includes(lineNb)||lines.push(lineNb),m.innerHTML=N,m.classList.add("text-valid"),m.classList.remove("text-invalid"),realLines.sort().toString()!=lines.sort().toString()?(document.getElementById("next")||function(){(f=document.createElement("button")).className="btn btn-success",f.id="next";let e=document.createTextNode("Continue");f.appendChild(e),document.querySelector("#complete").appendChild(f)}(),f.onclick=function(){rmEvent=!1;var e=[],t=[];if(e=x(lines),redId=0==redId?D[0]:redId,t=x(realLines),uia){let n=function(e,t){var n=e.indexOf(t);return e[n+1]}(k,D[0]),i=C(t,D[0]);e.length!=t.length&&D[0]!=t.slice(-1)[0]&&i==n?(a(N,j.slice(-1)[0]),lineNb=j.slice(-1)[0],T(lineNb,redId),O(lineNb),lineNb+=1,I()):t!=e&&t.slice(-1)[0]!=D[0]&&i!=n?(a(N,lineNb),T(lineNb,redId),O(lineNb),void 0===n&&(n=k[0]),lineNb=n<i?k[0]:n,I()):e.length!=t.length&&D[0]==t.slice(-1)[0]&&(a(N,j.slice(-1)[0]),lineNb=j.slice(-1)[0],T(lineNb,redId),O(lineNb),lineNb=k[0],I()),k.includes(lineNb)||(void 0!==i?(lineNb=i,I()):(lineNb=k[0],I())),D.length=0}else{let n=C($,lineNb);e.length!=t.length&&lineNb!=t.slice(-1)[0]?(a(N,lineNb),M(lineNb),lineNb+=1,I()):(e.length!=t.length&&e.includes(n)||e.length!=$.length&&lineNb==$.slice(-1)[0]&&!0===g||e.length==$.length&&lineNb==$.slice(-1)[0]&&!0===g)&&(a(N,lineNb),M(lineNb),lineNb=$[0],I()),$.includes(lineNb)||(n?(lineNb=n,I()):(lineNb=$[0],I()))}f.remove(),d("/aptc/",{reset:!1,lineNb:Number(lineNb),new_text:c,topicname,reveal_status:b,new_page:!0,dictation_id,vaseg:!0},o)}):realLines.sort().toString()==lines.sort().toString()&&(document.getElementById("conclude")||function(){(v=document.createElement("button")).className="btn btn-light",v.id="conclude";let e=document.createTextNode("Conclude");v.appendChild(e),document.querySelector("#complete").appendChild(v)}(),v.onclick=function(){realLines.sort().toString()==lines.sort().toString()&&(done=!1,document.getElementById("id_textarea").value="",g=!1,E=0,_(),r.innerHTML=lineNb,L(),a(N,lineNb),H(),uia&&(document.getElementById(lineNb).lastChild.classList.contains("red")?(document.getElementById(lineNb).lastChild.classList.remove("red"),document.getElementById(lineNb).lastChild.classList.add("green")):document.getElementById(redId)&&(document.getElementById(redId).lastChild.classList.remove("red"),document.getElementById(redId).lastChild.classList.add("green")))),v.remove(),d("/aptc/",{reset:!1,lineNb:Number(lineNb),new_text:c,topicname,reveal_status:b,new_page:!0,dictation_id,vaseg:!0},o),D.length=0})):(m.classList.add("text-invalid"),m.classList.remove("text-valid"),m.innerHTML=y)}(s||u)&&[s,u].forEach((e=>{e.addEventListener("click",(function(t){var n=document.getElementById("id_textarea").value;b=e===u,d("/aptc/",{reset:!1,line_nb:Number(lineNb),new_text:n,topicname,reveal_status:b,new_page:e===u&&!0===np,dictation_id,vaseg:!1},o).then((e=>{y=e.result,g=e.state,N=q(e.original),E=!0===np?0:e.reveal_attempts,P()})),e===u&&!0===np&&(np=!1)}))})),document.addEventListener("keydown",(e=>{if(e.ctrlKey&&(playCurrent(),done=!1,paused=!1),"Enter"===e.key){e.preventDefault();let t=document.getElementById("id_textarea").value;d("/aptc/",{reset:!1,line_nb:Number(lineNb),new_text:t,topicname,reveal_status:b,new_page:!0===np,dictation_id,vaseg:!1},o).then((e=>{y=e.result,g=e.state,N=q(e.original),E=!0===np?0:e.reveal_attempts,P()})),np=!1}}));const R=document.getElementById("previous"),A=document.getElementById("go-next"),F=document.getElementById("playstop"),J=document.getElementById("iplaystop"),U='<i class="fa-solid fa-lightbulb text-light"></i>';h.innerHTML=void 0!==tip[lineNb]?`${U} ${tip[lineNb]}`:h.innerHTML="",document.getElementById("playstop")&&F.addEventListener("click",(function(e){paused?(playCurrent(),done=!1,paused=!1):(pauseSegment(),paused=!0,J.classList.replace("fa-stop","fa-play"))})),document.getElementById("previous")&&R.addEventListener("click",(function(e){playPrevious(),h.innerHTML=void 0!==tip[lineNb]?`${U}  ${tip[lineNb]}`:h.innerHTML="",counter.innerHTML=lineNb,lines.includes(lineNb)?create_level_valid():del_level_valid(),reveal.innerHTML='<i class="fa-solid fa-0 w-ctrl"></i>',np=!0})),document.getElementById("go-next")&&A.addEventListener("click",(function(e){playNext(),h.innerHTML=void 0!==tip[lineNb]?`${U}  ${tip[lineNb]}`:h.innerHTML="",counter.innerHTML=lineNb,lines.includes(lineNb)?create_level_valid():del_level_valid(),done=!1,reveal.innerHTML='<i class="fa-solid fa-0 w-ctrl"></i>',np=!0})),n(818)})()})();
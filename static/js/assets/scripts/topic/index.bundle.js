(()=>{var e={344:()=>{document.getElementById("subh"),document.querySelector("main")&&document.querySelector("main"),document.addEventListener("dblclick",(function(){if(window.getSelection){var n=window.getSelection().toString(),i=[".",",",":",";","!","?","%","/","<",">","&","#",'"',"{","}","(",")","@","[","]","⭐"];for(char of n)i.includes(char)&&(n=n.replace(char,""));n.length>0&&n.length<26?dictmod.show():n=""}!i.includes(n)&&n.length>0&&fetch(prde,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8","X-CSRFToken":csrftoken},body:JSON.stringify(n)}).then((async i=>{if(!i.ok){const e=await i.text();throw new Error(e)}{var l=JSON.parse(i.headers.get("definition"));document.getElementById("dictionary-content")&&document.getElementById("dictionary-content").remove(),t.innerHTML="";let c=document.createElement("div");if(c.id="dictionary-content",divTitleContent=document.createTextNode(`${n.charAt(0).toUpperCase()+n.slice(1)}`),t.appendChild(divTitleContent),Object.keys(l).includes("no-result"))document.createElement("p"),pContent=document.createTextNode("No Definition found."),c.appendChild(pContent);else for(const[e,t]of Object.entries(l))if(Object.keys(t).length>0){(a=document.createElement("ul")).className="title";var a,d=document.createTextNode(`${e}`);(o=document.createElement("li")).appendChild(d),a.appendChild(o),c.appendChild(a),(a=document.createElement("ul")).className="def";for(const[e,n]of Object.entries(t)){let e=document.createTextNode(`${n}`);var o;(o=document.createElement("li")).appendChild(e),a.appendChild(o),c.appendChild(a)}}e.appendChild(c)}}))}));var e=document.getElementById("dictionary"),t=document.getElementById("dictionary-title")},779:()=>{const e=document.getElementById("blur");if(document.getElementById("blur-btn"))var t=document.getElementById("blur-btn"),n=document.getElementById("iblur");blurStatus=0,t&&(t.onclick=function(){0===blurStatus?(n.classList.replace("fa-droplet","fa-droplet-slash"),e.classList.add("blur-vid"),blurStatus=1):(n.classList.replace("fa-droplet-slash","fa-droplet"),e.classList.remove("blur-vid"),blurStatus=0)})},135:()=>{var e=document.getElementById("imgb64");if(document.getElementById("imgb64")){var t=function(e){var t,n,i,l={r:12.9,g:58.8,b:95.3},a=document.createElement("canvas"),d=a.getContext&&a.getContext("2d"),o=-4,c={r:0,g:0,b:0},r=0;if(!d)return l;n=a.height=e.naturalHeight||e.offsetHeight||e.height,t=a.width=e.naturalWidth||e.offsetWidth||e.width,d.drawImage(e,0,0);try{imageData=d.getImageData(0,0,t,n)}catch(e){return console.warn("Image not compatible"),l}for(i=imageData.data.length;(o+=20)<i;)++r,c.r+=imageData.data[o],c.g+=imageData.data[o+1],c.b+=imageData.data[o+2];return c.r=~~(c.r/r),c.g=~~(c.g/r),c.b=~~(c.b/r),c}(e);document.documentElement.style.setProperty("--dynamic-color",`rgb(${t.r}, ${t.g}, ${t.b})`),document.body.classList.add("background-gradient")}},818:()=>{document.querySelectorAll("input[type=radio][name=rate]").forEach((function(e){e.addEventListener("change",(function(t){t.preventDefault(),1==e.checked&&async function(e,t,n){try{const i=await fetch(e,{method:"POST",body:JSON.stringify(t),dataType:"json",headers:n});return await i.json()}catch(e){return console.warn(e)}}(aprr,{star_rating:t.target.value,dictation_id:t.target.id},{Accept:"application/json","Content-Type":"application/json","X-CSRFToken":csrftoken})}))}))}},t={};function n(i){var l=t[i];if(void 0!==l)return l.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,n),a.exports}(()=>{"use strict";n(344),n(779),n(135);var e=[],t=[];var i=document.getElementById("story-segment"),l=[];function a(n,a){let d=document.createElement("li"),o=document.createElement("i");o.className="fa-solid fa-copy custom-facp",l.includes(a)||(window[`textline${counter}`]=document.createTextNode(`${a} - ${n}`),l.push(a),d.appendChild(window[`textline${counter}`]),i.appendChild(d),t.push(n),window[`btn${lineNb}`]=document.createElement("button"),window[`btn${lineNb}`].className="btn",window[`btn${lineNb}`].id=`copy-${lineNb}`,window[`btn${lineNb}`].appendChild(o),d.appendChild(window[`btn${lineNb}`]),e.push(window[`btn${lineNb}`]),e.forEach((n=>{n.addEventListener("click",(function(i){!async function(e){try{await navigator.clipboard.writeText(e)}catch(e){return console.warn("Failed to copy: ",e)}}(t[e.indexOf(n)])}))})))}async function d(e,t,n){try{const i=await fetch(e,{method:"POST",body:JSON.stringify(t),headers:n});return await i.json()}catch(e){return console.warn(e)}}const o={Accept:"application/json","Content-Type":"application/json","X-CSRFToken":csrftoken};if(document.getElementById("id_textarea"))var c=document.getElementById("id_textarea").value;var r=document.getElementById("counter"),s=document.getElementById("check"),u=document.getElementById("reveal"),m=document.getElementById("result_correction"),p=0,b=!1,g=!1;const h=document.getElementById("tip");var f,y,N,v,E=0;function w(){p=ts[lineNb],player.seekTo(p,!0),player.playVideo(),done=!1,document.getElementById("id_textarea").value="",b=!1,m.innerHTML="",E=0,T(),r.innerHTML=lineNb,L()}function L(){h.innerHTML=void 0!==tip[lineNb]?`<i class="fa-solid fa-lightbulb"></i> ${tip[lineNb]}`:h.innerHTML=""}function T(){u.innerHTML=E?`<i class="fa-solid fa-${E} w-ctrl"></i>`:'<i class="fa-solid fa-0 w-ctrl"></i>',g=!1}function I(e){return e.toSorted(((e,t)=>e-t))}function _(e,t){var n=e.indexOf(t);return e[n+1]}function x(e,t){null!=document.getElementById(e)?(document.getElementById(e).lastChild.classList.remove("red"),document.getElementById(e).lastChild.classList.add("green")):null!=document.getElementById(t)&&(document.getElementById(t).lastChild.classList.remove("red"),document.getElementById(t).lastChild.classList.add("green"))}function C(e){return Math.floor(Math.random()*e)}const B=["Good job","Great job","Nice work"];var k=I(reds),S=I(realLines);function $(){let e=document.getElementById("exomodal");e.classList.contains("exodnone")&&e.classList.remove("exodnone"),e.classList.add("exodflex"),e.classList.replace("")}function H(e){let t=S.indexOf(e);return t>-1&&S.splice(t,1),S}function M(e){let t=k.indexOf(e);return t>-1&&k.splice(t,1),k}(function(){let e=document.getElementById("tcontainer");var t=document.createElement("div");t.id="exomodal",t.className="exomodal";let n=document.createElement("div");n.className="exomodal-content";let i=document.createElement("hr"),l=document.createElement("p");l.id="reset";let a=document.createTextNode(`${B[C(3)]}, you have finished this exercise. Please choose another or reset this one.`),d=document.createTextNode(`${B[C(3)]}, you have finished this exercise. You can refresh the page to do it again or choose another exercise.`),o=uia?a:d;l.appendChild(o),l.appendChild(i),n.appendChild(l),t.appendChild(n),e.insertBefore(t,e.firstChild),function(){let e=document.createElement("a");e.href=backhomeUrl,e.className="btn btn-success me-3 float-start",e.id="backhome";let t=document.createTextNode("Home");e.appendChild(t),document.querySelector("#reset").appendChild(e)}(),function(){let e=document.createElement("a"),t=uia?"Reset":"Refresh";e.className="btn btn-danger float-end",e.id="resetid";let n=document.createTextNode(t);e.appendChild(n),document.querySelector("#reset").appendChild(e)}()})(),document.getElementById("resetid").addEventListener("click",(function(){d("/aptc/",{reset:!0,lineNb:0,new_text:c,topicname,reveal_status:g,new_page:!0,dictation_id,vaseg:!1},o),location.reload()})),uia||document.getElementById("backhome").addEventListener("click",(function(){d("/aptc/",{reset:!0,lineNb:0,new_text:c,topicname,reveal_status:g,new_page:!0,dictation_id,vaseg:!1},o)})),uia&&!k.length>0&&window.addEventListener("load",$),document.onreadystatechange=()=>{"complete"===document.readyState&&d("/aptc/",{reset:!1,line_nb:Number(lineNb),new_text:c,topicname,reveal_status:g,new_page:!1,dictation_id,vaseg:!1},o)};var O=[],j=[];function D(e){return decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}function q(){0==j.length&&j.push(lineNb),!0===g&&(g=!1),u.innerHTML=E?`<i class="fa-solid fa-${E} w-ctrl"></i>`:'<i class="fa-solid fa-0 w-ctrl"></i>',N&&!0===b&&(O.includes(lineNb)||O.push(lineNb)),N&&!0===b?(lines.includes(lineNb)||lines.push(lineNb),m.innerHTML=v,m.classList.add("text-valid"),m.classList.remove("text-invalid"),realLines.sort().toString()!=lines.sort().toString()?(document.getElementById("next")||function(){(f=document.createElement("button")).className="btn btn-success",f.id="next";let e=document.createTextNode("Continue");f.appendChild(e),document.querySelector("#complete").appendChild(f)}(),f.onclick=function(){rmEvent=!1;var e=[],t=[];if(e=I(lines),redId=0==redId?j[0]:redId,t=I(realLines),uia){let n=function(e,t){var n=e.indexOf(t);return e[n+1]}(k,j[0]),i=_(t,j[0]);e.length!=t.length&&j[0]!=t.slice(-1)[0]&&i==n?(a(v,O.slice(-1)[0]),lineNb=O.slice(-1)[0],x(lineNb,redId),M(lineNb),lineNb+=1,w()):t!=e&&t.slice(-1)[0]!=j[0]&&i!=n?(a(v,lineNb),x(lineNb,redId),M(lineNb),void 0===n&&(n=k[0]),lineNb=n<i?k[0]:n,w()):e.length!=t.length&&j[0]==t.slice(-1)[0]&&(a(v,O.slice(-1)[0]),lineNb=O.slice(-1)[0],x(lineNb,redId),M(lineNb),lineNb=k[0],w()),k.includes(lineNb)||(void 0!==i?(lineNb=i,w()):(lineNb=k[0],w())),j.length=0}else{let n=_(S,lineNb);e.length!=t.length&&lineNb!=t.slice(-1)[0]?(a(v,lineNb),H(lineNb),lineNb+=1,w()):(e.length!=t.length&&e.includes(n)||e.length!=S.length&&lineNb==S.slice(-1)[0]&&!0===b||e.length==S.length&&lineNb==S.slice(-1)[0]&&!0===b)&&(a(v,lineNb),H(lineNb),lineNb=S[0],w()),S.includes(lineNb)||(n?(lineNb=n,w()):(lineNb=S[0],w()))}f.remove(),d("/aptc/",{reset:!1,lineNb:Number(lineNb),new_text:c,topicname,reveal_status:g,new_page:!0,dictation_id,vaseg:!0},o)}):realLines.sort().toString()==lines.sort().toString()&&(document.getElementById("conclude")||function(){(y=document.createElement("button")).className="btn btn-light",y.id="conclude";let e=document.createTextNode("Conclude");y.appendChild(e),document.querySelector("#complete").appendChild(y)}(),y.onclick=function(){realLines.sort().toString()==lines.sort().toString()&&(done=!1,document.getElementById("id_textarea").value="",b=!1,E=0,T(),r.innerHTML=lineNb,L(),a(v,lineNb),$(),uia&&(document.getElementById(lineNb).lastChild.classList.contains("red")?(document.getElementById(lineNb).lastChild.classList.remove("red"),document.getElementById(lineNb).lastChild.classList.add("green")):document.getElementById(redId)&&(document.getElementById(redId).lastChild.classList.remove("red"),document.getElementById(redId).lastChild.classList.add("green")))),y.remove(),d("/aptc/",{reset:!1,lineNb:Number(lineNb),new_text:c,topicname,reveal_status:g,new_page:!0,dictation_id,vaseg:!0},o),j.length=0})):(m.classList.add("text-invalid"),m.classList.remove("text-valid"),m.innerHTML=N)}(s||u)&&[s,u].forEach((e=>{e.addEventListener("click",(function(t){var n=document.getElementById("id_textarea").value;g=e===u,d("/aptc/",{reset:!1,line_nb:Number(lineNb),new_text:n,topicname,reveal_status:g,new_page:e===u&&!0===np,dictation_id,vaseg:!1},o).then((e=>{N=e.result,b=e.state,v=D(e.original),E=!0===np?0:e.reveal_attempts,q()})),e===u&&!0===np&&(np=!1)}))})),document.addEventListener("keydown",(e=>{if(e.ctrlKey&&(player&&player.seekTo(ts[lineNb],!0),window.clearTimeout(timeout),player.seekTo(ts[lineNb],!0),player.playVideo(),done=!1),"Enter"===e.key){e.preventDefault();let t=document.getElementById("id_textarea").value;d("/aptc/",{reset:!1,line_nb:Number(lineNb),new_text:t,topicname,reveal_status:g,new_page:!0===np,dictation_id,vaseg:!1},o).then((e=>{N=e.result,b=e.state,v=D(e.original),E=!0===np?0:e.reveal_attempts,q()})),np=!1}})),n(818);const V=document.getElementById("previous"),R=document.getElementById("go-next"),A=document.getElementById("playstop"),F=document.getElementById("iplaystop"),P='<i class="fa-solid fa-lightbulb text-light"></i>';function J(e){redId=e.target.parentElement.id,lineNb=Number(redId),h.innerHTML=void 0!==tip[lineNb]?`${P}  ${tip[lineNb]}`:h.innerHTML="",player.seekTo(ts[lineNb],!0),counter.innerHTML=lineNb,lines.includes(lineNb)?create_level_valid():del_level_valid(),window.clearTimeout(timeout),player.seekTo(ts[lineNb],!0),player.playVideo(),done=!1,np=!0,reveal.innerHTML='<i class="fa-solid fa-0 w-ctrl"></i>'}h.innerHTML=void 0!==tip[lineNb]?`${P} ${tip[lineNb]}`:h.innerHTML="",document.getElementById("playstop")&&A.addEventListener("click",(function(e){paused?(player.seekTo(ts[lineNb],!0),window.clearTimeout(timeout),player.playVideo(),done=!1,paused=!1):(player.pauseVideo(),paused=!0,F.classList.replace("fa-stop","fa-play"))})),redleds.forEach((e=>{!0===rmEvent?e.removeEventListener("click",J,{passive:!0}):e.addEventListener("click",J)})),document.getElementById("previous")&&V.addEventListener("click",(function(e){lineNb>=1&&(lineNb-=1),h.innerHTML=void 0!==tip[lineNb]?`${P}  ${tip[lineNb]}`:h.innerHTML="",player.seekTo(ts[lineNb],!0),counter.innerHTML=lineNb,lines.includes(lineNb)?create_level_valid():del_level_valid(),window.clearTimeout(timeout),player.seekTo(ts[lineNb],!0),player.playVideo(),done=!1,reveal.innerHTML='<i class="fa-solid fa-0 w-ctrl"></i>',np=!0})),document.getElementById("go-next")&&R.addEventListener("click",(function(e){lineNb<totl&&(lineNb+=1),h.innerHTML=void 0!==tip[lineNb]?`${P}  ${tip[lineNb]}`:h.innerHTML="",player.seekTo(ts[lineNb],!0),counter.innerHTML=lineNb,lines.includes(lineNb)?create_level_valid():del_level_valid(),window.clearTimeout(timeout),player.seekTo(ts[lineNb],!0),player.playVideo(),done=!1,reveal.innerHTML='<i class="fa-solid fa-0 w-ctrl"></i>',np=!0}))})()})();
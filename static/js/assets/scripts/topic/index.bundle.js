(()=>{var e={418:()=>{const e=document.getElementById("blur");if(document.getElementById("blur-btn"))var t=document.getElementById("blur-btn"),n=document.getElementById("iblur");blurStatus=0,t&&(t.onclick=function(){0===blurStatus?(n.classList.replace("fa-droplet","fa-droplet-slash"),e.classList.add("blur-vid"),blurStatus=1):(n.classList.replace("fa-droplet-slash","fa-droplet"),e.classList.remove("blur-vid"),blurStatus=0)})},490:()=>{var e=document.getElementById("imgb64");if(document.getElementById("imgb64")){var t=function(e){var t,n,i,a={r:12.9,g:58.8,b:95.3},l=document.createElement("canvas"),o=l.getContext&&l.getContext("2d"),d=-4,c={r:0,g:0,b:0},r=0;if(!o)return a;n=l.height=e.naturalHeight||e.offsetHeight||e.height,t=l.width=e.naturalWidth||e.offsetWidth||e.width,o.drawImage(e,0,0);try{imageData=o.getImageData(0,0,t,n)}catch(e){return console.warn("Image not compatible"),a}for(i=imageData.data.length;(d+=20)<i;)++r,c.r+=imageData.data[d],c.g+=imageData.data[d+1],c.b+=imageData.data[d+2];return c.r=~~(c.r/r),c.g=~~(c.g/r),c.b=~~(c.b/r),c}(e);document.body.style.backgroundColor=`rgb(${t.r}, ${t.g}, ${t.b})`}},851:()=>{let e=document.getElementById("subh");if(document.querySelector("main"))var t=document.querySelector("main");document.addEventListener("dblclick",(function(){if(window.getSelection)var n=window.getSelection().toString();fetch(prde,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8","X-CSRFToken":csrftoken},body:JSON.stringify(n)}).then((async i=>{if(!i.ok){const e=await i.text();throw new Error(e)}{document.getElementById("tt")&&document.getElementById("tt").remove(),document.getElementById("define")&&document.getElementById("define").remove();let d=document.createElement("div"),c=document.createElement("div");c.id="define",c.className="def-container";let r=document.createElement("span");r.className="cross";let s=document.createElement("div");s.className="deft",divTitleContent=document.createTextNode(`${n.charAt(0).toUpperCase()+n.slice(1)}`),s.appendChild(divTitleContent),s.prepend(r),d.className="winbox";let m=document.createElement("ul");var a=JSON.parse(i.headers.get("definition"));for(let e=0;e<Object.keys(a).length;e++){var l=document.createElement("li");let t=document.createTextNode(`${a[e]}`);l.appendChild(t),m.appendChild(l)}Object.keys(a).length>0&&(d.prepend(m),c.prepend(d),c.prepend(s),(e||t).prepend(c));var o=document.getElementById("define");r.addEventListener("click",(function(){o.remove();let e=document.createElement("div");e.id="tt",e.className="tooltipz",divttContent=document.createTextNode("Get word definition"),e.appendChild(divttContent);let n=document.createElement("span");n.className="bg-info p-2 float-end mb-3 tooltiptext",spanttContent=document.createTextNode("Double click on a word to get its definition"),n.appendChild(spanttContent),e.prepend(n),t.prepend(e)}))}}))}))},148:()=>{document.querySelectorAll("input[type=radio][name=rate]").forEach((function(e){e.addEventListener("change",(function(t){t.preventDefault(),1==e.checked&&async function(e,t,n){try{const i=await fetch(e,{method:"POST",body:JSON.stringify(t),dataType:"json",headers:n});return await i.json()}catch(e){return console.warn(e)}}(aprr,{star_rating:t.target.value,dictation_id:t.target.id},{Accept:"application/json","Content-Type":"application/json","X-CSRFToken":csrftoken})}))}))}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var l=t[i]={exports:{}};return e[i](l,l.exports,n),l.exports}(()=>{"use strict";n(851),n(418),n(490);var e=[],t=[];var i=document.getElementById("story-segment");function a(n){n=n.slice(0,-1);let a=document.createElement("li"),l=document.createElement("i");l.className="fa-solid fa-copy style='color: #a8bb24;'",window[`textline${counter}`]=document.createTextNode(n),a.appendChild(window[`textline${counter}`]),i.appendChild(a),t.push(n),window[`btn${lineNb}`]=document.createElement("button"),window[`btn${lineNb}`].className="btn",window[`btn${lineNb}`].id=`copy-${lineNb}`,window[`btn${lineNb}`].appendChild(l),a.appendChild(window[`btn${lineNb}`]),e.push(window[`btn${lineNb}`]),e.forEach((n=>{n.addEventListener("click",(function(i){!async function(e){try{await navigator.clipboard.writeText(e)}catch(e){return console.warn("Failed to copy: ",e)}}(t[e.indexOf(n)])}))}))}async function l(e,t,n){try{const i=await fetch(e,{method:"POST",body:JSON.stringify(t),headers:n});return await i.json()}catch(e){return console.warn(e)}}const o={Accept:"application/json","Content-Type":"application/json","X-CSRFToken":csrftoken};if(document.getElementById("id_textarea"))var d=document.getElementById("id_textarea").value;var c=document.getElementById("counter"),r=document.getElementById("check"),s=document.getElementById("reveal"),m=document.getElementById("result_correction"),u=0,p=!1,b=!1;const y=document.getElementById("tip");var g,f,v,h;function N(){!0===b&&(b=!1),s.innerHTML=`<i class="fa-solid fa-${h} w-ctrl"></i>`;let e=document.getElementById("next");f&&!0===p?(m.innerHTML=v,m.classList.add("text-valid"),m.classList.remove("text-invalid"),!e&&lineNb<ts.length-2?(function(){(g=document.createElement("button")).className="btn btn-success",g.id="next";let e=document.createTextNode("Next");g.appendChild(e),document.querySelector("#complete").appendChild(g)}(),g.onclick=function(){lineNb<ts.length-2&&!0===p&&(lineNb+=1,u=ts[lineNb],player.seekTo(u,!0),player.playVideo(),done=!1,document.getElementById("id_textarea").value="",p=!1,m.innerHTML="",h=0,s.innerHTML=`<i class="fa-solid fa-${h} w-ctrl"></i>`,c.innerHTML=lineNb,lines.push(lineNb-1),y.innerHTML=void 0!==tip[lineNb]?`<i class="fa-solid fa-lightbulb"></i> TIP: ${tip[lineNb]}`:y.innerHTML="",a(v),l(aptc,{lineNb,new_text:d,topicname,reveal_status:b,new_page:!0,dictation_id},o)),g.remove()}):lineNb==ts.length-2&&!0===p&&(lines.push(lineNb-1),console.log("congrats",lines,totl),m.innerHTML="This is the end, nice work, congrats! :)",a(v))):(m.classList.add("text-invalid"),m.classList.remove("text-valid"),m.innerHTML=f)}(r||s)&&[r,s].forEach((e=>{e.addEventListener("click",(function(t){var n=document.getElementById("id_textarea").value;b=e===s,l(aptc,{lineNb,new_text:n,topicname,reveal_status:b,new_page:!1,dictation_id},o).then((e=>{f=e.result,p=e.state,v=e.original,h=e.reveal_attempts,N()}))}))})),document.addEventListener("keydown",(e=>{if(e.ctrlKey&&(player&&player.seekTo(ts[lineNb],!0),window.clearTimeout(timeout),player.seekTo(ts[lineNb],!0),player.playVideo(),done=!1),"Enter"===e.key){e.preventDefault();let t=document.getElementById("id_textarea").value;l(aptc,{lineNb,new_text:t,topicname,reveal_status:b,new_page:!1,dictation_id},o).then((e=>{f=e.result,p=e.state,v=e.original,h=e.reveal_attempts,N()}))}})),n(148);const w=document.getElementById("previous"),E=document.getElementById("go-next"),T=document.getElementById("playstop"),I=document.getElementById("iplaystop"),L='<i class="fa-solid fa-lightbulb" style="color: #ffffff;"></i>';y.innerHTML=void 0!==tip[lineNb]?`${L} TIP: ${tip[lineNb]}`:y.innerHTML="",document.getElementById("playstop")&&T.addEventListener("click",(function(e){paused?(player.seekTo(ts[lineNb],!0),window.clearTimeout(timeout),player.playVideo(),done=!1,paused=!1):(player.pauseVideo(),paused=!0,I.classList.replace("fa-stop","fa-play"))})),document.getElementById("previous")&&w.addEventListener("click",(function(e){lineNb>=1&&(lineNb-=1),y.innerHTML=void 0!==tip[lineNb]?`${L}  TIP: ${tip[lineNb]}`:y.innerHTML="",player.seekTo(ts[lineNb],!0),counter.innerHTML=lineNb,lines.includes(lineNb)?create_level_valid():del_level_valid(),window.clearTimeout(timeout),player.seekTo(ts[lineNb],!0),player.playVideo(),done=!1,reveal.innerHTML=`<i class="fa-solid fa-${revealAttempts} w-ctrl"></i>`})),document.getElementById("go-next")&&E.addEventListener("click",(function(e){lineNb<totl&&(lineNb+=1),y.innerHTML=void 0!==tip[lineNb]?`${L}  TIP: ${tip[lineNb]}`:y.innerHTML="",player.seekTo(ts[lineNb],!0),counter.innerHTML=lineNb,lines.includes(lineNb)?create_level_valid():del_level_valid(),window.clearTimeout(timeout),player.seekTo(ts[lineNb],!0),player.playVideo(),done=!1,reveal.innerHTML=`<i class="fa-solid fa-${revealAttempts} w-ctrl"></i>`})),document.getElementById("previous")&&previous.addEventListener("click",(function(){lineNb>0&&i.lastElementChild&&i.removeChild(i.lastElementChild)}))})()})();